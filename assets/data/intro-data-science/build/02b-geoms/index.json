{"hash":"ac97d0240b0403f422f54a34c582b35e428a3a84","data":{"metadata":{"siteName":"Siuba tutorials","siteDescription":""},"page":{"id":"6698ef05a76b90168bf54a8575976c5d","title":"Geoms","content":"\n<Notebook\n  v-slot=\"nb\"\n  branch=\"master\"\n  repo=\"machow/purview\"\n  url=\"https://mybinder.org\"\n  useBinder=\"1\"\n  useStorage=\"1\"\n  >\n\n\n<details v-fix-codemirror v-show=\"nb.debut\">\n<code-cell  :status=\"nb.status\" :onExecute=\"nb.execute\" :onReady=\"nb.updateSetupCode\"  language=\"python\">\n\n\n    # TODO: explain how to run this, and that they only need the gist (loads tools)\n    \n    # wranglign ---------\n    import pandas as pd\n    from siuba import *\n    \n    # plotting ----------\n    from plotnine import *\n    \n    theme_set(theme_classic(base_family = \"Noto Sans CJK JP\"))\n    \n    # data --------------\n    #fname = \"/Users/machow/Dropbox/Repo/siublocks-org/intro-tidyverse/tutorial/data/music200.csv\"\n    fname = \"https://siublocks.s3.us-east-2.amazonaws.com/course-data/music200.csv\"\n    music_top200 = pd.read_csv(fname)\n    \n    # tracks\n    #fname = \"/Users/machow/Dropbox/Repo/siublocks-org/intro-tidyverse/tutorial/data/track_features.csv\"\n    fname = \"https://siublocks.s3.us-east-2.amazonaws.com/course-data/track_features.csv\"\n    track_features = pd.read_csv(fname)\n    \n    # student support ----------\n    from siuba import pipe\n    from IPython.display import HTML, display\n    from siututor import Blank\n    ___ = Blank()\n    \n    # DataFrame display --------\n    pd.set_option(\"display.max_rows\", 6)\n    \n    from IPython import get_ipython\n    # special ipython function to get the html formatter\n    html_formatter = get_ipython().display_formatter.formatters['text/html']\n    \n    # here, we avoid the default df._repr_html_ method, since it inlines css\n    # (style tags make vue angry)\n    html_formatter.for_type(\n        pd.DataFrame,\n        lambda df: df.to_html(max_rows = pd.get_option(\"display.max_rows\"), show_dimensions = True)\n    )\n    \n    \n\n\n\n\n</code-cell>\n</details>\n\nimport slides from '../slides/02b-slides.markdown'\n\n<RevealSlides :slides=\"slides\" />\n\n### Exercise 1:\n\nThe options below let you change different arguments to `geom_text()`. Try changing them and running the code, in order to get a readable plot. Then, answer the questions underneath the plot.\n\nimport CodeCellTemplater from '~/components/Cell/CodeCellTemplater.vue'\n\n<CodeCellTemplater\n    :templateVars=\"$frontmatter.exercise_pars[0]\"\n    :status=\"nb.status\" :onExecute=\"nb.execute\" language=\"python\"\n    >\n\n    (track_features\n      >> filter(_.artist == \"Queen\")\n      >> ggplot(aes(\"energy\", \"valence\", label = \"track_name\"))\n       + geom_point()\n       + geom_text(size = ${this.size}, ha = \"${this.ha}\", ${this.nudge})\n    )    \n    \n<template v-slot:output>\n\n![](../assets/02b-queen-plot.png)\n\n\n</template>    \n\n</CodeCellTemplater>\n\n<p>Below are three songs at different corners of the graph. Can you tell whether they have high or low energy? Valence? Which do you think has low energy and low valence?</p>\n\n\n<div style=\"display: flex; width: 100%; flex-grow: 1;\">\n<div style=\"flex: 1 0;\">\n<p>Hammer to Fall</p>\n\n<iframe width=\"200\" src=\"https://www.youtube.com/embed/JU5LMG3WFBw\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n</div>\n<div style=\"flex: 1 0;\">\n<p>Crazy Little Thing Called Love</p>\n\n<iframe width=\"200\" src=\"https://www.youtube.com/embed/zO6D_BAuYCI\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n</div>\n<div style=\"flex: 1 0;\">\n<p>Love of My Life</p>\n\n<iframe width=\"200\" src=\"https://www.youtube.com/embed/7hFeER3_ZRQ\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n</div>\n</div>\n\n### Exercise 2:\n\nThis exercise is a case study on selecting extreme differences between two features, such as energy and acousticness.\n\nAt the end of the case study, you'll prompted to add code!\n\nGenerally tracks with higher energy tend to be less acoustic, as shown in the plot below.\n\n<code-cell  :status=\"nb.status\" :onExecute=\"nb.execute\"  ex=\"a\" :exIndx=\"0\" language=\"python\">\n\n\n    (track_features\n      >> filter(_.popularity > 33)\n      >> ggplot(aes(\"energy\", \"acousticness\"))\n       + geom_point()\n    )\n\n\n<template v-slot:output>\n\n    findfont: Font family ['Noto Sans CJK JP'] not found. Falling back to DejaVu Sans.\n    findfont: Font family ['Noto Sans CJK JP'] not found. Falling back to DejaVu Sans.\n\n\n\n![png](./02b-geoms_files/02b-geoms_7_1.png)\n\n\n\n\n\n    <ggplot: (-9223372036576871536)>\n\n\n\n</template>\n\n</code-cell>\n\n\nBut notice that in the plot above, there's a point in the top right, that is high energy and high acousticness.\n\nIn order to find high energy and acousticness songs like this, I used the following code.\n\n<code-cell  :status=\"nb.status\" :onExecute=\"nb.execute\"  ex=\"a\" :exIndx=\"0\" language=\"python\">\n\n\n    (track_features\n      >> filter(_.energy > .9, _.popularity > 33)\n      >> arrange(-_.acousticness)\n    )\n\n\n<template v-slot:output>\n\n\n\n\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>artist</th>\n      <th>album</th>\n      <th>track_name</th>\n      <th>energy</th>\n      <th>valence</th>\n      <th>danceability</th>\n      <th>speechiness</th>\n      <th>acousticness</th>\n      <th>popularity</th>\n      <th>duration</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>23990</th>\n      <td>MC Kevin o Chris</td>\n      <td>Vamos pra Gaiola</td>\n      <td>Vamos pra Gaiola</td>\n      <td>0.971</td>\n      <td>0.521</td>\n      <td>0.872</td>\n      <td>0.2810</td>\n      <td>0.917000</td>\n      <td>61</td>\n      <td>161.600</td>\n    </tr>\n    <tr>\n      <th>5211</th>\n      <td>ScHoolboy Q</td>\n      <td>CrasH Talk</td>\n      <td>Black Folk</td>\n      <td>0.902</td>\n      <td>0.400</td>\n      <td>0.734</td>\n      <td>0.3960</td>\n      <td>0.831000</td>\n      <td>51</td>\n      <td>147.040</td>\n    </tr>\n    <tr>\n      <th>24929</th>\n      <td>MC Kevin o Chris</td>\n      <td>Eu Vou pro Baile da Gaiola</td>\n      <td>Eu Vou pro Baile da Gaiola</td>\n      <td>0.957</td>\n      <td>0.642</td>\n      <td>0.832</td>\n      <td>0.1050</td>\n      <td>0.824000</td>\n      <td>52</td>\n      <td>123.220</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>18951</th>\n      <td>Foo Fighters</td>\n      <td>There Is Nothing Left To Lose</td>\n      <td>Learn to Fly</td>\n      <td>0.919</td>\n      <td>0.537</td>\n      <td>0.465</td>\n      <td>0.0408</td>\n      <td>0.000018</td>\n      <td>74</td>\n      <td>235.293</td>\n    </tr>\n    <tr>\n      <th>20425</th>\n      <td>Foo Fighters</td>\n      <td>One By One (Expanded Edition)</td>\n      <td>Times Like These</td>\n      <td>0.908</td>\n      <td>0.265</td>\n      <td>0.377</td>\n      <td>0.0899</td>\n      <td>0.000014</td>\n      <td>68</td>\n      <td>265.560</td>\n    </tr>\n    <tr>\n      <th>21871</th>\n      <td>Turmion Kätilöt</td>\n      <td>Global Warning</td>\n      <td>Jumalauta</td>\n      <td>0.939</td>\n      <td>0.549</td>\n      <td>0.454</td>\n      <td>0.0618</td>\n      <td>0.000010</td>\n      <td>42</td>\n      <td>210.107</td>\n    </tr>\n  </tbody>\n</table>\n<p>812 rows × 10 columns</p>\n\n\n\n</template>\n\n</code-cell>\n\n\nCan you plot songs by MC Kevin o Chris, with both points and text?\n\n<code-cell  :status=\"nb.status\" :onExecute=\"nb.execute\"  ex=\"a\" :exIndx=\"0\" language=\"python\">\n\n\n    (track_features\n      >> filter(_.artist == \"MC Kevin o Chris\")\n      >> ___\n    )\n\n\n<template v-slot:output>\n\n\n\n\n⚠️: <b>Don't forget to replace all the blanks!</b>\n\n\n\n</template>\n\n</code-cell>\n\n\nWhy do you think Vamos pra Gaiola is high energy and high acousticness?\n\n<iframe width=\"200\" src=\"https://www.youtube.com/embed/0R6zBcV9JiY\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n\n<details><summary>answer</summary>\nMy best guess is because the drums are done by a persons voice, there are few instruments, but it is still a pretty fast tempo. It would be interesting to look at their other tracks for a comparison.\n</details>\n\nCan you modify each code block in the case study to be about high energy and low danceability songs?\n\n\n</Notebook>\n\n","chapters":[],"authors":[],"resources":[]}},"context":{}}