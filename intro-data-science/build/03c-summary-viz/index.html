<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Visualizing summaries - Siuba tutorials</title><meta name="gridsome:hash" content="ac97d0240b0403f422f54a34c582b35e428a3a84"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.13"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="og:url" name="og:url" content="undefined/"><meta data-vue-tag="ssr" name="author" content=""><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.4c9809035c230f0e6cac26955353be8b.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.4c9809035c230f0e6cac26955353be8b.png"><link rel="preload" href="/assets/css/0.styles.c34a8c55.css" as="style"><link rel="preload" href="/assets/js/app.69957853.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--course-landing-vue.ce85efa0.js" as="script"><link rel="preload" href="/assets/js/vue-remark--tutorial--intro-data-science--build--03-c-summary-viz-md.15c7dd35.js" as="script"><link rel="prefetch" href="/assets/js/28.7f66d074.js"><link rel="prefetch" href="/assets/js/29.b590fc22.js"><link rel="prefetch" href="/assets/js/30.a4ca9897.js"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.d41f8f26.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.25b6b392.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.0048a42a.js"><link rel="prefetch" href="/assets/js/page--src--pages--test-vue.286dfaee.js"><link rel="prefetch" href="/assets/js/page--src--templates--post-vue.b9af215f.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--demo--01-g-test-md.352f1b04.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-b-filter-md.f257010b.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-c-arrange-md.bf803d70.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-d-mutate-md.ca742187.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-f-wrap-up-md.876933a5.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--01-intro-data-science-md.8f8e3298.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--02-a-intro-data-viz-md.bb00ddc6.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--02-b-geoms-md.5d7619d5.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--02-c-aesthetics-md.0271e7b3.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--02-d-facets-md.d730f813.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--03-a-summarize-md.7128f71f.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--03-b-group-by-md.fc5a4420.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--04-a-line-plots-md.ee00024f.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--04-b-barcharts-md.2bcb8ba7.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--04-c-histograms-md.463d6d5c.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--build--04-d-boxplot-md.822720f0.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--cheatsheet-md.33541ee0.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--index-md.8ec8aaa1.js"><link rel="prefetch" href="/assets/js/vue-remark--tutorial--intro-data-science--readme-md.6d83fea3.js"><link rel="stylesheet" href="/assets/css/0.styles.c34a8c55.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout" data-v-1f94fe02><h1 class="course-title" data-v-1f94fe02>Visualizing summaries</h1><div class="container" data-v-1f94fe02><div class="main" data-v-1f94fe02></div><div class="sidebar" data-v-1f94fe02><div class="resources sidebar-box" data-v-1f94fe02><h3 class="box-title" data-v-1f94fe02>resources</h3></div><div class="authors sidebar-box" data-v-1f94fe02><h3 class="box-title" data-v-1f94fe02>authors</h3></div></div></div><div data-v-1f94fe02><div><details style="display:none;"><div language="python" class="code-cell--container"><div class="top-bar"><div class="is-pulled-right"><!----><div class="v-spinner" style="display:none;"><div class="v-pulse v-pulse1" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.12s;"></div><div class="v-pulse v-pulse2" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.24s;"></div><div class="v-pulse v-pulse3" style="background-color:#5dc596;width:8px;height:8px;margin:2px;border-radius:100%;display:inline-block;animation-name:v-pulseStretchDelay;animation-duration:0.75s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-fill-mode:both;animation-delay:0.36s;"></div></div></div></div><div class="vue-codemirror"><textarea name="codemirror" placeholder=""></textarea></div><button>run</button><button>reset</button><div class="code-cell--output"><div></div><div class="container-editor container"></div></div></div></details><div><div class="reveal-container"><div class="reveal show-notes"><div class="slides"><section class=""><section class=""> <h1 id=visualizing-summarized-data>Visualizing summarized data</h1> <aside class=notes> <p>In this chapter you learned to use the group by and summarize verbs to summarize the music_top200 data by year, by continent, or by both.</p> <p>Now you&#39;ll learn how to turn those summaries into informative visualizations, by returning to the plotnine package from Chapter 2.</p> </aside></section></section><section class=""><section class=""> <h1 id=when-visualizing-raw-data-doesnt-work>When visualizing raw data doesn&#39;t work</h1> <pre><code class=language-python>(music_top200
  &gt;&gt; ggplot(aes(&quot;position&quot;, &quot;streams&quot;, color = &quot;country&quot;))
   + geom_point()
)</code></pre> <p><img src=/assets/img/03c-slides_4_0.3ebbfec5.png alt=png></p> <pre><code>&lt;ggplot: (-9223372036580980273)&gt;</code></pre><aside class=notes> <p>Suppose we want to look at how many streams countries have. We could make a scatterplot showing each track in each country, like in the plot on the slide.</p> <p>However, there are so many countries that it is hard to read, and half the plot is the legend that shows what color each country is.</p> </aside></section></section><section class=""><section class=""> <h1 id=calculating-min-and-max-streams>Calculating min and max streams</h1> <pre><code class=language-python>by_position = (
  music_top200
  &gt;&gt; group_by(_.position)
  &gt;&gt; summarize(max_streams = _.streams.max(),
               min_streams = _.streams.min())
)
by_position</code></pre> <div> <style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe thead th{text-align:right}</style><p></p> <table border=1 class=dataframe> <thead> <tr style=text-align:right> <th></th> <th>position</th> <th>max_streams</th> <th>min_streams</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>1</td> <td>12987027</td> <td>13604</td> </tr> <tr> <th>1</th> <td>2</td> <td>9163134</td> <td>10801</td> </tr> <tr> <th>2</th> <td>3</td> <td>8043475</td> <td>9510</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>197</th> <td>198</td> <td>1606234</td> <td>1472</td> </tr> <tr> <th>198</th> <td>199</td> <td>1606153</td> <td>1470</td> </tr> <tr> <th>199</th> <td>200</td> <td>1597824</td> <td>1470</td> </tr> </tbody> </table> <p>200 rows × 3 columns</p> </div> <aside class=notes> <p>Rather than plotting the raw data, we can plot a summary.</p> <p>For example, previously we summarized data by continent and position, to find the max and min streams.</p> <p>Let&#39;s do that again, but instead of viewing the summarized data as a table, let&#39;s save it as an object called by_continent_position, so you can visualize the data using plotnine.</p> </aside></section></section><section class="font-size-sm img-height-300"><section class="font-size-sm img-height-300"> <h1 id=plotting>Plotting</h1> <pre><code class=language-python>(by_position
  &gt;&gt; ggplot(aes(&quot;position&quot;, &quot;max_streams&quot;))
   + geom_point()
   + labs(title = &quot;Top 200 hits - max streams overall&quot;)
)</code></pre> <aside class=notes> <p>You would construct the graph with the three steps of plotnine:</p> <ul> <li>The data, which is by_year.</li> <li>The aesthetics, which puts year on the x-axis and total population on the y-axis.</li> <li>The type of graph, which in this case is a scatter plot, represented by geom_point.</li> </ul> <p>Notice that the steps are the same as when you were graphing countries in a scatter plot, even though it&#39;s a new dataset.</p> </aside></section></section><section class="font-size-sm img-height-300"><section class="font-size-sm img-height-300"> <h1 id=plotting-result>Plotting (result)</h1> <pre><code class=language-python>(by_position
  &gt;&gt; ggplot(aes(&quot;position&quot;, &quot;max_streams&quot;))
   + geom_point()
   + labs(title = &quot;Top 200 hits - max streams overall&quot;)
)</code></pre> <p><img src=/assets/img/03c-slides_13_0.ba3fc677.png alt=png></p> <pre><code>&lt;ggplot: (294997021)&gt;</code></pre><aside class=notes> <p>The resulting graph of max streams by position, which is much easier to read than the previous plot with all the raw data.</p> <p>The top track is (by definition) the most streamed, with about 100 million streams!</p> <p>You might notice that the graph is a little misleading because it doesn&#39;t include zero: It&#39;s hard to get a a sense of how many streams the last position track had, since it is at the bottom of the graph.</p> </aside></section></section><section class="font-size-sm img-height-300"><section class="font-size-sm img-height-300"> <h1 id=starting-y-axis-at-0>Starting y-axis at 0</h1> <pre><code class=language-python>(by_position
  >> ggplot(aes("position", "max_streams"))
   + geom_point()
   <mark>+ expand_limits(y = 0)</mark>
   + labs(title = "Top 200 hits - max streams overall"))</code></pre> <p><img src=/assets/img/03c-slides_17_0.073c644f.png alt=png></p> <pre><code>&lt;ggplot: (-9223372036559787811)&gt;</code></pre><aside class=notes> <p>This is a good time to introduce another graphing option. By adding &quot;expand underscore limits y = 0&quot; to the end of the ggplot call, you can specify that you want the y-axis to start at zero.</p> <p>Notice that you added it to the end just like you would with facet_wrap.</p> <p>Now the graph makes it clearer that the top position track has over three times as many streams, as the lowest position one.</p> <p>You could have created other graphs of summarized data, such as a graph of the average streams rather than max, by changing the y aesthetic.</p> </aside><aside class=notes> </aside></section></section><section class=""><section class=""> <h1 id=calculating-min-and-max-streams-1>Calculating min and max streams</h1> <pre><code class=language-python>by_continent_position = (
  music_top200
  &gt;&gt; group_by(_.continent, _.position)
  &gt;&gt; summarize(max_streams = _.streams.max(),
               min_streams = _.streams.min())
)
by_continent_position</code></pre> <div> <style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}.dataframe thead th{text-align:right}</style><p></p> <table border=1 class=dataframe> <thead> <tr style=text-align:right> <th></th> <th>continent</th> <th>position</th> <th>max_streams</th> <th>min_streams</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>Africa</td> <td>1</td> <td>94422</td> <td>94422</td> </tr> <tr> <th>1</th> <td>Africa</td> <td>2</td> <td>74689</td> <td>74689</td> </tr> <tr> <th>2</th> <td>Africa</td> <td>3</td> <td>67552</td> <td>67552</td> </tr> <tr> <th>...</th> <td>...</td> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <th>997</th> <td>Oceania</td> <td>198</td> <td>225951</td> <td>44570</td> </tr> <tr> <th>998</th> <td>Oceania</td> <td>199</td> <td>225492</td> <td>44364</td> </tr> <tr> <th>999</th> <td>Oceania</td> <td>200</td> <td>225179</td> <td>44291</td> </tr> </tbody> </table> <p>1000 rows × 4 columns</p> </div> <aside class=notes> <p>So far you&#39;ve been graphing the by-position summarized data. But you have also learned to summarize after grouping by both position and continent, to see how much countries are streaming top tracks on different continents continents.</p> </aside></section></section><section class="font-size-sm img-height-300"><section class="font-size-sm img-height-300"> <h1 id=visualize>Visualize</h1> <pre><code class=language-python>(by_continent_position
  &gt;&gt; ggplot(aes(&quot;position&quot;, &quot;max_streams&quot;, color = &quot;continent&quot;))
   + geom_point()
   + expand_limits(y = 0)
   + labs(title = &quot;Top 200 hits - max streams overall&quot;))</code></pre> <p><img src=/assets/img/03c-slides_24_0.a908c50c.png alt=png></p> <pre><code>&lt;ggplot: (295035975)&gt;</code></pre><aside class=notes> <p>Since you now have data over position within each continent, you need a way to separate it in a visualization. </p> <p>To do that you can use the color aesthetic you learned about in chapter two.</p> <p>By setting color equals continent, you can show five separate trends on the same graph.</p> <p>This lets us see that a country in the Americas has a hit tracks with a large number of streams, while there aren&#39;t any countries in Africa doing a lot of streaming spotify hits (for more on companies competing to stream in Africa, see <a href=https://weetracker.com/2020/05/13/music-streaming-africa/ >this article</a>).</p> </aside></section></section><section class=""><section class=""> <h1 id=lets-practice>Let&#39;s practice!</h1> <aside class=notes> <p>You&#39;ll often combine siuba verbs and plotnine visualizations as part of an exploratory analysis, so it&#39;s important to get into the habit of visualizing summarized or processed data.</p> <p>Scroll down to investigate the music data with filter.</p> </aside></section></section></div></div></div></div><h3 id="exercise-1"><a href="#exercise-1" aria-hidden="true"><span class="fa fa-link"></span></a>Exercise 1</h3><h3 id="exercise-2"><a href="#exercise-2" aria-hidden="true"><span class="fa fa-link"></span></a>Exercise 2</h3><h3 id="exercise-3"><a href="#exercise-3" aria-hidden="true"><span class="fa fa-link"></span></a>Exercise 3</h3><!----></div></div></div>
    <script>window.__INITIAL_STATE__={"data":{"metadata":{"siteName":"Siuba tutorials","siteDescription":""},"page":{"id":"8e7310b2762c49e1aa56df35fb6fd01b","title":"Visualizing summaries","content":"\n\u003CNotebook\n  v-slot=\"nb\"\n  branch=\"master\"\n  repo=\"machow\u002Fpurview\"\n  url=\"https:\u002F\u002Fmybinder.org\"\n  useBinder=\"1\"\n  useStorage=\"1\"\n  \u003E\n\n\n\u003Cdetails v-fix-codemirror v-show=\"nb.debut\"\u003E\n\u003Ccode-cell  :status=\"nb.status\" :onExecute=\"nb.execute\" :onReady=\"nb.updateSetupCode\"  language=\"python\"\u003E\n\n\n    # TODO: explain how to run this, and that they only need the gist (loads tools)\n    \n    # wranglign ---------\n    import pandas as pd\n    from siuba import *\n    \n    # plotting ----------\n    from plotnine import *\n    \n    theme_set(theme_classic(base_family = \"Noto Sans CJK JP\"))\n    \n    # data --------------\n    #fname = \"\u002FUsers\u002Fmachow\u002FDropbox\u002FRepo\u002Fsiublocks-org\u002Fintro-tidyverse\u002Ftutorial\u002Fdata\u002Fmusic200.csv\"\n    fname = \"https:\u002F\u002Fsiublocks.s3.us-east-2.amazonaws.com\u002Fcourse-data\u002Fmusic200.csv\"\n    music_top200 = pd.read_csv(fname)\n    \n    # tracks\n    #fname = \"\u002FUsers\u002Fmachow\u002FDropbox\u002FRepo\u002Fsiublocks-org\u002Fintro-tidyverse\u002Ftutorial\u002Fdata\u002Ftrack_features.csv\"\n    fname = \"https:\u002F\u002Fsiublocks.s3.us-east-2.amazonaws.com\u002Fcourse-data\u002Ftrack_features.csv\"\n    track_features = pd.read_csv(fname)\n    \n    # student support ----------\n    from siuba import pipe\n    from IPython.display import HTML, display\n    from siututor import Blank\n    ___ = Blank()\n    \n    # DataFrame display --------\n    pd.set_option(\"display.max_rows\", 6)\n    \n    from IPython import get_ipython\n    # special ipython function to get the html formatter\n    html_formatter = get_ipython().display_formatter.formatters['text\u002Fhtml']\n    \n    # here, we avoid the default df._repr_html_ method, since it inlines css\n    # (style tags make vue angry)\n    html_formatter.for_type(\n        pd.DataFrame,\n        lambda df: df.to_html(max_rows = pd.get_option(\"display.max_rows\"), show_dimensions = True)\n    )\n    \n    \n\n\n\n\n\u003C\u002Fcode-cell\u003E\n\u003C\u002Fdetails\u003E\n\n\nimport slides from '..\u002Fslides\u002F03c-slides.markdown'\n\n\u003CRevealSlides :slides=\"slides\" \u002F\u003E\n\n### Exercise 1\n\n### Exercise 2\n\n### Exercise 3\n\n\n\u003C\u002FNotebook\u003E\n\n","chapters":[],"authors":[],"resources":[]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.69957853.js" defer></script><script src="/assets/js/page--src--templates--course-landing-vue.ce85efa0.js" defer></script><script src="/assets/js/vue-remark--tutorial--intro-data-science--build--03-c-summary-viz-md.15c7dd35.js" defer></script>
  </body>
</html>
